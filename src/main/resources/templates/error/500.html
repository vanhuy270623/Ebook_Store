<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>500 - Lỗi máy chủ</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        body {
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 50%, #fecfef 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .error-container {
            background: white;
            border-radius: 20px;
            padding: 60px 40px;
            text-align: center;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            max-width: 600px;
            margin: 0 auto;
        }

        .error-icon {
            font-size: 120px;
            color: #dc3545;
            margin-bottom: 30px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .error-code {
            font-size: 72px;
            font-weight: 900;
            color: #dc3545;
            margin-bottom: 20px;
        }

        .error-message {
            font-size: 24px;
            color: #555;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .error-description {
            color: #666;
            margin-bottom: 40px;
            line-height: 1.6;
        }

        .btn-home, .btn-reload {
            border: none;
            padding: 15px 30px;
            font-size: 16px;
            font-weight: 600;
            border-radius: 50px;
            text-decoration: none;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            margin: 0 10px;
        }

        .btn-home {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-reload {
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%);
            color: white;
        }

        .btn-home:hover, .btn-reload:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            color: white;
        }

        .error-details {
            margin-top: 40px;
            padding-top: 40px;
            border-top: 1px solid #eee;
            font-size: 14px;
            color: #666;
        }

        .error-id {
            background: #f8f9fa;
            padding: 10px 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            margin-top: 15px;
        }

        .support-info {
            margin-top: 30px;
            background: #e3f2fd;
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid #2196f3;
        }

        .support-info h6 {
            color: #1976d2;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="error-container">
            <div class="error-icon">
                <i class="fas fa-exclamation-triangle"></i>
            </div>

            <div class="error-code">500</div>

            <h1 class="error-message">Lỗi máy chủ nội bộ</h1>

            <p class="error-description">
                Xin lỗi! Đã xảy ra lỗi không mong muốn trên máy chủ.
                Chúng tôi đang làm việc để khắc phục sự cố này.
                Vui lòng thử lại sau hoặc liên hệ bộ phận hỗ trợ.
            </p>

            <div>
                <button class="btn-reload" onclick="window.location.reload()">
                    <i class="fas fa-redo"></i>
                    Thử lại
                </button>

                <a href="/" class="btn-home">
                    <i class="fas fa-home"></i>
                    Về trang chủ
                </a>
            </div>

            <div class="error-details" th:if="${timestamp != null or path != null or error != null or message != null}">
                <h6>Chi tiết lỗi:</h6>
                <div th:if="${timestamp != null}">
                    <strong>Thời gian:</strong> <span th:text="${timestamp}"></span>
                </div>
                <div th:if="${path != null}">
                    <strong>URL:</strong> <span th:text="${path}"></span>
                </div>
                <div th:if="${error != null}">
                    <strong>Loại lỗi:</strong> <span th:text="${error}"></span>
                </div>
                <div th:if="${message != null}">
                    <strong>Thông báo:</strong> <span th:text="${message}"></span>
                </div>

                <div class="error-id">
                    <strong>Mã lỗi:</strong> <span th:text="${#dates.format(#dates.createNow(), 'yyyyMMddHHmmss')}" th:unless="${timestamp}">[[${timestamp}]]</span>
                </div>
            </div>

            <div class="support-info">
                <h6><i class="fas fa-life-ring"></i> Cần hỗ trợ?</h6>
                <p class="mb-2">
                    <i class="fas fa-envelope"></i>
                    <strong>Email:</strong> support@ebookstore.com
                </p>
                <p class="mb-0">
                    <i class="fas fa-phone"></i>
                    <strong>Hotline:</strong> 1900 1234
                </p>
            </div>
        </div>
    </div>

    <script>
        // Auto reload after 30 seconds if user doesn't take action
        setTimeout(function() {
            if (confirm('Tự động tải lại trang sau 30 giây. Bạn có muốn tải lại ngay bây giờ?')) {
                window.location.reload();
            }
        }, 30000);

        // Log error details to console for debugging
        console.error('Server Error 500:', {
            timestamp: '[[${timestamp}]]',
            path: '[[${path}]]',
            error: '[[${error}]]',
            message: '[[${message}]]'
        });
    </script>
</body>
</html>

